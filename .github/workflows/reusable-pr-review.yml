# vibeCop PR Review Workflow (Stub)
#
# TODO: MVP 2 - Implement reviewdog-based PR diff commenting
#
# This workflow will:
# - Run lint in diff mode (only changed files)
# - Use reviewdog to comment on PR diffs
# - Not create issues (PR-only feedback)

name: vibeCop PR Review

on:
  workflow_call:
    inputs:
      trunk_arguments:
        description: 'Arguments to pass to trunk check'
        required: false
        default: 'check'
        type: string
    secrets:
      GH_TOKEN:
        description: 'GitHub token for PR comments'
        required: true

permissions:
  contents: read
  pull-requests: write

jobs:
  pr-review:
    name: PR Lint Review
    runs-on: ubuntu-latest
    if: github.event_name == 'pull_request'

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup reviewdog
        uses: reviewdog/action-setup@v1

      - name: Setup Trunk
        uses: trunk-io/trunk-action@v1
        with:
          check-mode: diff
          # Only check changed files
          arguments: ${{ inputs.trunk_arguments }}

      # TODO: Implement reviewdog integration
      # - Parse Trunk output
      # - Format for reviewdog
      # - Post comments on changed lines only

      - name: Placeholder
        run: |
          echo "PR Review workflow is a stub for MVP 2"
          echo "See vibeCop_spec.md section 9.2 for implementation details"
